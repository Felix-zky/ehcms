<!doctype html>
<html lang="zh">
<head>
	<meta charset="UTF-8">
	<link rel="stylesheet" type="text/css" href="./css/style.css" />
</head>
<body>
	<header></header>
	<section id="iframe-main" class="container-fluid">
		<div class="menu-tree open">
			<div class="logo">
				<img src="../logo_default.png">
			</div>
			<!-- <div class="search">
				<input type="text" />
			</div> -->
			<ul class="level-1">
				<li>
					<div class="row">
						<i class="fa fa-plus-circle"></i>
						<span>第一行</span>
					</div>
					<ul class="level-2">
						<li data-url = 'http://www.baidu.com'>
							<div class="row">
								<i class="fa fa-plus-circle"></i>
								<span>百度</span>
							</div>
						</li>
						<li data-url = "http://www.163.com">
							<div class="row">
								<i class="fa fa-plus-circle"></i>
								<span>网易</span>
							</div>
						</li>
					</ul>
				</li>

				<li>
					<div class="row">
						<i class="fa fa-plus-circle"></i>
						<span>第二行</span>
					</div>
					<ul class="level-2">
						<li>
							<div class="row">
								<i class="fa fa-plus-circle"></i>
								<span>第一行</span>
							</div>
						</li>
						<li>
							<div class="row">
								<i class="fa fa-plus-circle"></i>
								<span>第一行</span>
							</div>
						</li>
					</ul>
				</li>
				<li>
					<div class="row">
						<i class="fa fa-plus-circle"></i>
						<span>第三行</span>
					</div>
					<ul class="level-2">
						<li>
							<div class="row">
								<i class="fa fa-plus-circle"></i>
								<span>第一行</span>
							</div>
						</li>
						<li>
							<div class="row">
								<i class="fa fa-plus-circle"></i>
								<span>第一行</span>
							</div>
						</li>
					</ul>
				</li>
				<li>
					<div class="row">
						<i class="fa fa-plus-circle"></i>
						<span>第四行</span>
					</div>
					<ul class="level-2">
						<li>
							<div class="row">
								<i class="fa fa-plus-circle"></i>
								<span>第一行</span>
							</div>
						</li>
						<li>
							<div class="row">
								<i class="fa fa-plus-circle"></i>
								<span>第一行</span>
							</div>
						</li>
					</ul>
				</li>
			</ul>
		</div>
		<div class="content">
			<iframe  frameborder="0" width="100%" height="100%"></iframe>
			<div class="loading">
				<div class="tips">
					<i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i><span>页面正在加载...</span>
				</div>
			</div>
		</div>
	</section>
</body>
<script type="text/javascript" src="./js/jquery.js"></script>
<script type="text/javascript" src="./js/jquery.contextMenu.js"></script>
<script type="text/javascript" src="./js/layer/layer.js"></script>
<script type="text/javascript">
	$(document).ready(function(){
		contentWidthCompute();

		$(window).resize(function() {
			contentWidthCompute();
		});

		$('.menu-tree li').on('transitionend', function(){
			$(this).removeClass('wait');
		});

		/** 菜单树li元素点击触发（无限级） */
		$('.menu-tree li').click(function(e){
			if (!$('.menu-tree').is('.open')){
				return false;
			}

			e.stopPropagation();

			var childrenUI = $(this).children('ul');

			if (childrenUI.length > 0){
				if ($('.menu-tree .wait').length > 0){
					return false;
				}

				$(this).addClass('wait');

				//当前如果是打开状态被点击就隐藏掉
				if ($(this).is('.selected')) {
					$(this).css({
						height: ($(this).outerHeight() - childrenUI.outerHeight()) + 'px'
					});
					$(this).children('.row').children('i').removeClass('fa-minus-circle').addClass('fa-plus-circle');
					$(this).removeClass('selected');
					$(this).find('.selected').removeClass('selected');
				}else{
					//如果当前是关闭状态被点击首先判断是否存在已经打开的菜单列表，如果存在将其隐藏掉。
					var selected = $(this).siblings('li.selected');

					selected.css({
						height: (selected.outerHeight() - selected.children('ul').outerHeight()) + 'px'
					});

					selected.children('.row').children('i').removeClass('fa-minus-circle').addClass('fa-plus-circle');

					selected.find('.selected').removeClass('selected');

					//当前触发对象获取被被选中状态
					$(this).css({
						height: ($(this).outerHeight() + childrenUI.outerHeight()) + 'px'
					});
					$(this).addClass('selected').siblings('li').removeClass('selected');
					$(this).children('.row').children('i').removeClass('fa-plus-circle').addClass('fa-minus-circle');
				}
			}else{
				var url = $(this).data('url');

				$(this).addClass('selected').siblings('li').removeClass('selected');
					
				if (url) {
					if ($('iframe').attr('src') != url) {
						iframe(url);
					}else{
						layer.confirm('您确定要重新打开本页面吗？', {btn: ['确定', '取消']}, 
							function(index){
								iframe(url);
								layer.close(index);
							}
						);
					}
				}
			}
		});
	});
	
	/**
	 * 计算右侧内容区宽度
	 */
	function contentWidthCompute(){
		var windowWidth = $(window).outerWidth();
		$('.content').css({
			width: (windowWidth - 218) + 'px'
		});
	}

	/**
	 * 隐藏iframe框并提示加载，加载完成后关闭提示并显示iframe框
	 */
	function iframe(url){
		$('iframe').css({
			opacity: 0
		});

		$('iframe').attr('src', url);

		$('.loading').show();

		$('iframe').load(function(){
			$('iframe').css({
				opacity: 1
			});
			$('.loading').hide();
		});
	}
</script>
</html>